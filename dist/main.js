!function(){"use strict";!function(){class t{constructor(t){this.velocityX=0,this.velocityY=0,this.dimensions=t.dimensions,this.positionX=this.dimensions.width,this.positionY=this.dimensions.height/2,this.hitBox={},this.vector=0,this.game=t,this.trackBox=new Path2D,this.downHillBox=new Path2D}isCollidedWith(t){let i={};for(let s in this.hitBox){let e=this.hitBox[s];(this.game.ctx.isPointInPath(t.trackBox,e[0],e[1])||this.game.ctx.isPointInPath(t.downHillBox,e[0],e[1]))&&(i[s]=e)}return"{}"===JSON.stringify(i)&&(i=!1),i}}class i extends t{constructor(t){super(t),this.velocityX=0,this.positionY=i.getRandomInt(0,this.dimensions.height),this.vector=Math.atan(.125)}firstTrack(){this.positionY=this.game.dimensions.height/3*2,this.positionX=this.dimensions.width/5}animate(){this.moveTrack(),this.drawDownHill(),this.boundBy()}drawDownHill(){this.downHillBox=new Path2D,this.game.ctx.fillStyle="orangered",this.downHillBox.moveTo(this.positionX,this.positionY),this.downHillBox.lineTo(this.positionX+800,this.positionY+100),this.downHillBox.lineTo(this.positionX+800,this.positionY+120),this.downHillBox.lineTo(this.positionX,this.positionY+20),this.downHillBox.closePath(),this.game.ctx.fill(this.downHillBox)}drawFlat(){this.trackBox=new Path2D,this.center=[this.positionX+s.TRACK_L/2,this.positionY+s.TRACK_H/2],this.trackBox.rect(this.positionX,this.positionY,s.TRACK_L,s.TRACK_H),this.game.ctx.fillStyle="orangered",this.game.ctx.fill(this.trackBox)}drawCurve(){}moveTrack(){this.positionX-=this.velocityX}boundBy(){this.hitBox.topLeft=[this.positionX,this.positionY],this.hitBox.topRight=[this.positionX+s.TRACK_L,this.positionY]}static getRandomInt(t,i){return Math.random()*(i-t)+t}}const s={TRACK_H:20,TRACK_L:900,VECTOR:Math.PI/32};class e extends t{constructor(t){super(t),this.positionX=this.dimensions.width/4,this.velocityX=h.VEL_X,this.velocityY=h.VEL_Y,this.vector=0,this.jumpPower=.5,this.grounded=!1,this.rotation=!0,this.landing=!1,this.hypotenuse=Math.sqrt(Math.pow(h.CAR_WIDTH/2,2)+Math.pow(h.CAR_HEIGHT/2,2)),this.theta=Math.atan(h.CAR_HEIGHT/2/(h.CAR_WIDTH/2))}animate(){this.jump(),this.rotateCar(),this.move(),this.drawCar(),this.isBoundBy(),this.landedOnTrack(),this.landProperly()}move(){this.positionX+=this.velocityX,this.positionY+=this.velocityY,!1===this.grounded&&this.velocityY<h.TERMINAL_VEL&&(this.velocityY+=h.GRAVITY),!0===this.game.keyState.forward?this.velocityX=4:this.velocityX=0}jump(){!0===this.game.keyState.spaceDown?this.jumpPower<=1.5&&(this.jumpPower+=.25):!0===this.game.keyState.spaceRelease&&(!0===this.grounded&&(this.velocityY=-h.TERMINAL_VEL*this.jumpPower,this.grounded=!1),this.game.keyState.spaceRelease=!1,this.jumpPower=.5)}rotateCar(){!0===this.game.keyState.leftDown&&!1===this.grounded?(this.rotation=!0,this.vector+=-Math.PI/64):!0===this.game.keyState.rightDown&&!1===this.grounded?(this.rotation=!0,this.vector+=Math.PI/64):this.rotation=!1}drawCar(){this.carBox=new Path2D,this.game.ctx.save(),this.center=[this.positionX+h.CAR_WIDTH/2,this.positionY+h.CAR_HEIGHT/2],!0!==this.rotation&&0==this.vector||(this.game.ctx.translate(...this.center),this.game.ctx.rotate(this.vector%(2*Math.PI)),this.game.ctx.translate(-this.center[0],-this.center[1])),this.carBox.rect(this.positionX,this.positionY,h.CAR_WIDTH,h.CAR_HEIGHT),this.game.ctx.fillStyle="orangered",this.game.ctx.fill(this.carBox),this.game.ctx.restore()}isBoundBy(){let t=this.vector+this.theta,i=this.vector-this.theta,s=-this.vector+this.theta,e=-this.vector-this.theta,o=[this.vector,-this.vector],n=[];[t,i,s,e].forEach(((t,i)=>{let s=this.hypotenuse*Math.cos(t),e=this.hypotenuse*Math.sin(t);i<2?n.push([this.center[0]+s,this.center[1]+e]):n.push([this.center[0]-s,this.center[1]+e])})),this.hitBox.bottomRight=n[0],this.hitBox.topRight=n[1],this.hitBox.bottomLeft=n[2],this.hitBox.topLeft=n[3],o.forEach(((t,i)=>{let s=h.CAR_WIDTH/2*Math.cos(t),e=h.CAR_WIDTH/2*Math.sin(t);0===i?n.push([this.center[0]+s,this.center[1]+e]):n.push([this.center[0]-s,this.center[1]+e])})),this.hitBox.rightSide=n[4],this.hitBox.leftSide=n[5]}landedOnTrack(){for(let t=0;t<this.game.tracks.length;t++){let i=this.isCollidedWith(this.game.tracks[t]);if(!1!==i){this.velocityY=0,this.landingVector=this.game.tracks[t].vector,2===Object.keys(i).length?(this.landing=!1,this.grounded=!0,this.vector=this.landingVector):(this.landing=i,this.grounded=!1);break}this.landing=!1,this.grounded=!1}}landProperly(){if(!1!==this.landing){let t=this.vector%(2*Math.PI);this.landing.hasOwnProperty("bottomRight")?t-Math.PI/32>this.landingVector?this.vector=this.landingVector:(this.rotation=!0,this.vector+=-Math.PI/64):this.landing.hasOwnProperty("bottomLeft")&&(t+Math.PI/32<this.landingVector?this.vector=this.landingVector:(this.rotation=!0,this.vector+=Math.PI/64))}}}const h={GRAVITY:.8,TERMINAL_VEL:12,CAR_WIDTH:80,CAR_HEIGHT:50,VEL_X:0,VEL_Y:0};class o{constructor(t){this.ctx=t.getContext("2d"),this.dimensions={width:t.width,height:t.height},this.MAP_WIDTH=4e3,this.MAP_HEIGHT=2e3,this.keyState={spaceDown:!1,spaceRelease:!1,leftDown:!1,rightDown:!1,forward:!1},document.addEventListener("keydown",this.keyDown.bind(this)),document.addEventListener("keyup",this.keyUp.bind(this)),t.addEventListener("click",this.restartButton.bind(this))}drawBackground(t){t.fillStyle="skyblue",t.fillRect(0,0,this.dimensions.width,this.dimensions.height)}drawRestart(t){t.fillStyle="orangered",t.fillRect(this.dimensions.width/12*11,this.dimensions.height/8*7,60,60),t.font="36px serif",t.fillStyle="white",t.fillText("R",this.dimensions.width/16*15,this.dimensions.height/18*17)}animate(){this.drawBackground(this.ctx),this.drawRestart(this.ctx),this.animateTracks(),this.car.animate(),!0===this.running&&requestAnimationFrame(this.animate.bind(this))}restart(){this.tracks=this.createTracks(),this.car=new e(this),this.running=!1,this.play()}restartButton(){for(;this.tracks.length>1;)this.tracks.pop();this.tracks[0].firstTrack(),this.car.positionX=this.dimensions.width/4,this.car.positionY=this.dimensions.height/2,this.car.vector=0}play(){this.running=!0,this.animate()}setCamera(){this.cameraX=-this.MAP_WIDTH/2}createTracks(){const t=[];let s=new i(this);return s.firstTrack(),t.push(s),t}regulateTracks(){if(this.tracks[this.tracks.length-1].hitBox.topRight[0]<this.dimensions.width){let t=new i(this);this.tracks.push(t)}this.tracks[0].hitBox.topRight[0]<0&&this.tracks.shift()}animateTracks(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].animate(),this.regulateTracks()}keyDown(t){"Space"===t.code&&!0===this.running?this.keyState.spaceDown=!0:"ArrowLeft"===t.code&&!0===this.running?this.keyState.leftDown=!0:"ArrowRight"===t.code&&!0===this.running?this.keyState.rightDown=!0:"ArrowUp"===t.code&&!0===this.running&&(this.keyState.forward=!0)}keyUp(t){"Space"===t.code&&!0===this.running?(this.keyState.spaceRelease=!0,this.keyState.spaceDown=!1):"ArrowLeft"===t.code&&!0===this.running?this.keyState.leftDown=!1:"ArrowRight"===t.code&&!0===this.running?this.keyState.rightDown=!1:"ArrowUp"===t.code&&!0===this.running&&(this.keyState.forward=!1)}}window.addEventListener("DOMContentLoaded",(()=>{const t=document.getElementById("canvas");t.width=900,t.height=600,new o(t).restart()}))}()}();
//# sourceMappingURL=main.js.map